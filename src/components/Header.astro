<header data-nav 
class="fixed top-0 lg:top-4 left-1/2 -translate-x-1/2 z-50 flex justify-center items-center px-8 py-5 lg:px-6 lg:py-3 lg:mt-6 w-full lg:w-auto lg:border-[3px] lg:rounded-full lg:border-[#c9e8ff] hover:border-[#ff6622] border-opacity-90 transition-all duration-200 ease-in-out">
    
    <!-- Desktop Navigation -->
    <nav data-nav-inner class="hidden lg:flex flex-nowrap whitespace-nowrap items-center flex-row gap-x-16 font-bold">
        <a class="hover:text-[#ff6622] nav-link transition-colors duration-200" href="#sobre-mi" id="nav-sobre-mi">
            Sobre mí
        </a>
        <a class="hover:text-[#ff6622] nav-link transition-colors duration-200" href="#tecnologias" id="nav-tecnologias">
            Tecnologías
        </a>
        <a class="hover:text-[#ff6622] nav-link transition-colors duration-200" href="#proyectos" id="nav-proyectos">
            Proyectos
        </a>
        <a class="hover:text-[#ff6622] nav-link transition-colors duration-200" href="#experiencia" id="nav-experiencia">
            Experiencia
        </a>
        <a class="hover:text-[#ff6622] nav-link transition-colors duration-200" href="#contacto" id="nav-contacto">
            Contacto
        </a>
    </nav>

    <!-- Mobile/Tablet Navigation -->
    <div class="lg:hidden flex items-center justify-between w-full px-6">
        <!-- Logo -->
        <div class="flex items-center">
            <img src="favicon.png" alt="Logo" class="w-8 h-8">
        </div>
        
        <!-- Hamburger Menu Button -->
        <button 
            id="mobile-menu-btn" 
            class="flex justify-center items-center w-10 h-10 focus:outline-none group text-white hover:text-[#ff6622] transition-colors duration-300"
            aria-label="Toggle menu"
        >
            <svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform duration-300" id="hamburger-icon">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M7 6h10" />
                <path d="M4 12h16" />
                <path d="M7 12h13" />
                <path d="M7 18h10" />
            </svg>
        </button>
    </div>

    <!-- Mobile Menu (dropdown bajo el navbar; no tapa el header) -->
<div 
  id="mobile-menu" 
  class="lg:hidden absolute top-full left-1/2 -translate-x-1/2 mt-2
         w-[92vw] max-w-5xl rounded-2xl border-2 border-white/10
         bg-[#0b0f1a] shadow-2xl max-h-[70vh] overflow-y-auto
         opacity-0 invisible transition-all duration-200 ease-out z-40">
  <div class="flex flex-col items-center py-4 space-y-6">
    <a class="text-2xl font-bold text-[#c9e8ff] hover:text-[#ff6622] transition-colors duration-200 mobile-nav-link flex items-center gap-3" href="#sobre-mi" data-target="nav-sobre-mi">
      <svg  xmlns="http://www.w3.org/2000/svg"  width="26"  height="26"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-user"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 2a5 5 0 1 1 -5 5l.005 -.217a5 5 0 0 1 4.995 -4.783z" /><path d="M14 14a5 5 0 0 1 5 5v1a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-1a5 5 0 0 1 5 -5h4z" /></svg>
      Sobre mí
    </a>
    <a class="text-2xl font-bold text-[#c9e8ff] hover:text-[#ff6622] transition-colors duration-200 mobile-nav-link flex items-center gap-3" href="#tecnologias" data-target="nav-tecnologias">
      <svg  xmlns="http://www.w3.org/2000/svg"  width="26"  height="26"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brain"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15.5 13a3.5 3.5 0 0 0 -3.5 3.5v1a3.5 3.5 0 0 0 7 0v-1.8" /><path d="M8.5 13a3.5 3.5 0 0 1 3.5 3.5v1a3.5 3.5 0 0 1 -7 0v-1.8" /><path d="M17.5 16a3.5 3.5 0 0 0 0 -7h-.5" /><path d="M19 9.3v-2.8a3.5 3.5 0 0 0 -7 0" /><path d="M6.5 16a3.5 3.5 0 0 1 0 -7h.5" /><path d="M5 9.3v-2.8a3.5 3.5 0 0 1 7 0v10" /></svg>
      Tecnologías
    </a>
    <a class="text-2xl font-bold text-[#c9e8ff] hover:text-[#ff6622] transition-colors duration-200 mobile-nav-link flex items-center gap-3" href="#proyectos" data-target="nav-proyectos">
      <svg  xmlns="http://www.w3.org/2000/svg"  width="26"  height="26"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-folders"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 2a1 1 0 0 1 .707 .293l1.708 1.707h4.585a3 3 0 0 1 2.995 2.824l.005 .176v7a3 3 0 0 1 -3 3h-1v1a3 3 0 0 1 -3 3h-10a3 3 0 0 1 -3 -3v-9a3 3 0 0 1 3 -3h1v-1a3 3 0 0 1 3 -3zm-6 6h-1a1 1 0 0 0 -1 1v9a1 1 0 0 0 1 1h10a1 1 0 0 0 1 -1v-1h-7a3 3 0 0 1 -3 -3z" /></svg>
      Proyectos
    </a>
    <a class="text-2xl font-bold text-[#c9e8ff] hover:text-[#ff6622] transition-colors duration-200 mobile-nav-link flex items-center gap-3" href="#experiencia" data-target="nav-experiencia">
      <svg  xmlns="http://www.w3.org/2000/svg"  width="26"  height="26"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-briefcase"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 13.478v4.522a3 3 0 0 1 -3 3h-14a3 3 0 0 1 -3 -3v-4.522l.553 .277a20.999 20.999 0 0 0 18.897 -.002l.55 -.275zm-8 -11.478a3 3 0 0 1 3 3v1h2a3 3 0 0 1 3 3v2.242l-1.447 .724a19.002 19.002 0 0 1 -16.726 .186l-.647 -.32l-1.18 -.59v-2.242a3 3 0 0 1 3 -3h2v-1a3 3 0 0 1 3 -3h4zm-2 8a1 1 0 0 0 -1 1a1 1 0 1 0 2 .01c0 -.562 -.448 -1.01 -1 -1.01zm2 -6h-4a1 1 0 0 0 -1 1v1h6v-1a1 1 0 0 0 -1 -1z" /></svg>
      Experiencia
    </a>
    <a class="text-2xl font-bold text-[#c9e8ff] hover:text-[#ff6622] transition-colors duration-200 mobile-nav-link flex items-center gap-3" href="#contacto" data-target="nav-contacto">
      <svg  xmlns="http://www.w3.org/2000/svg"  width="26"  height="26"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-message"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 3a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-4.724l-4.762 2.857a1 1 0 0 1 -1.508 -.743l-.006 -.114v-2h-1a4 4 0 0 1 -3.995 -3.8l-.005 -.2v-8a4 4 0 0 1 4 -4zm-4 9h-6a1 1 0 0 0 0 2h6a1 1 0 0 0 0 -2m2 -4h-8a1 1 0 1 0 0 2h8a1 1 0 0 0 0 -2" /></svg>
      Contacto
    </a>
  </div>
</div>

   <script is:inline>
  // @ts-check
  const header = document.querySelector('header[data-nav]');
  if (header) {
      const THRESHOLD = 60;
      /**
       * @param {boolean} on
       */
      const apply = (on) => {
          header.classList.toggle('bg-transparent', !on);
          header.classList.toggle('bg-[#0b0f1a]', on);
          header.classList.toggle('border-opacity-85', on);
      };
      const onScroll = () => apply(window.scrollY > THRESHOLD);
      onScroll();
      window.addEventListener('scroll', onScroll, { passive: true });
  }

  // Mobile menu functionality
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const hamburgerIcon = document.getElementById('hamburger-icon');
  const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
  
  let isMenuOpen = false;

  const toggleMenu = () => {
    if (!mobileMenu || !hamburgerIcon) return;
    
    isMenuOpen = !isMenuOpen;
    
    if (isMenuOpen) {
      // Show menu
      mobileMenu.classList.remove('opacity-0', 'invisible');
      mobileMenu.classList.add('opacity-100', 'visible');
      
      // Rotate hamburger icon
      hamburgerIcon.style.transform = 'rotate(90deg)';
      
      // Prevent body scroll
      if (document.body) {
        document.body.style.overflow = 'hidden';
      }
    } else {
      // Hide menu
      mobileMenu.classList.remove('opacity-100', 'visible');
      mobileMenu.classList.add('opacity-0', 'invisible');
      
      // Reset hamburger icon rotation
      hamburgerIcon.style.transform = 'rotate(0deg)';
      
      // Restore body scroll
      if (document.body) {
        document.body.style.overflow = '';
      }
    }
  };

  if (mobileMenuBtn) {
    mobileMenuBtn.addEventListener('click', toggleMenu);
  }

  document.addEventListener('click', (e) => {
  if (!isMenuOpen || !mobileMenu || !mobileMenuBtn) return;
  const t = e.target;
  if (!(t instanceof Node)) return;

  if (!mobileMenu.contains(t) && !mobileMenuBtn.contains(t)) {
    toggleMenu();
  }
});

  // Close menu when clicking outside (on overlay)
  if (mobileMenu) {
    mobileMenu.addEventListener('click', (e) => {
      if (e.target === mobileMenu) {
        toggleMenu();
      }
    });
  }

  // Close menu on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && isMenuOpen) {
      toggleMenu();
    }
  });

  // Active nav link for both desktop and mobile
  const sections = [
    { id: 'sobre-mi', nav: 'nav-sobre-mi' },
    { id: 'tecnologias', nav: 'nav-tecnologias' },
    { id: 'proyectos', nav: 'nav-proyectos' },
    { id: 'experiencia', nav: 'nav-experiencia' },
    { id: 'contacto', nav: 'nav-contacto' }
  ];

  function setActiveNav() {
    let activeIdx = 0;
    sections.forEach((section, idx) => {
      const el = document.getElementById(section.id);
      if (el) {
        const rect = el.getBoundingClientRect();
        if (rect.top <= 120 && rect.bottom > 120) {
          activeIdx = idx;
        }
      }
    });
    
    // Update desktop nav
    sections.forEach((section, idx) => {
      const link = document.getElementById(section.nav);
      if (link) {
        link.classList.toggle('text-[#ff6622]', idx === activeIdx);
        link.classList.toggle('text-[#c9e8ff]', idx !== activeIdx);
      }
    });
    
    // Update mobile nav
    mobileNavLinks.forEach((link, idx) => {
      if (sections[idx]) {
        link.classList.toggle('text-[#ff6622]', idx === activeIdx);
        link.classList.toggle('text-[#c9e8ff]', idx !== activeIdx);
      }
    });
  }
  
  window.addEventListener('scroll', setActiveNav, { passive: true });
  window.addEventListener('DOMContentLoaded', setActiveNav);

  // Handle window resize
  window.addEventListener('resize', () => {
    if (window.innerWidth >= 1024 && isMenuOpen) {
      // Close mobile menu if window becomes large
      toggleMenu();
    }
  });

  // Cerrar el menú al pulsar cualquier enlace del menú móvil
mobileNavLinks.forEach((link) => {
  link.addEventListener('click', () => {
    if (isMenuOpen) toggleMenu(); // restaura scroll y resetea el icono
  });
});
  
  // Wait for DOM to be fully loaded before initializing
  document.addEventListener('DOMContentLoaded', () => {
    // Re-query elements after DOM is loaded
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    const icon = document.getElementById('hamburger-icon');
    const links = document.querySelectorAll('.mobile-nav-link');
    
    // Ensure all elements exist before setting up event listeners
    if (btn && menu && icon && links.length > 0) {
      console.log('Mobile menu initialized successfully');
    }
  });
</script>
</header>